pre-commit:
  piped: true
  commands:
    stylua:
      glob: "*.lua"
      run: stylua {staged_files} -f ./stylua.toml
    fish_indenet:
      glob: "*.fish"
      run: fish_indent -w {staged_files}
    yamlfmt:
      glob: "*.{yml,yaml}"
      run: yamlfmt {staged_files}
    just-fmt:
      glob: "justfile"
      run: just --fmt --unstable
    check_diff:
      run: |
        # ä½œæ¥­ãƒ„ãƒªãƒ¼ã®å¤‰æ›´ã‚’ä¸€æ™‚é€€é¿ï¼ˆã‚¹ãƒ†ãƒ¼ã‚¸ã•ã‚ŒãŸã‚‚ã®ã¯ä¿æŒï¼‰
        git stash push --keep-index --quiet --include-untracked || true

        # å·®åˆ†ãƒã‚§ãƒƒã‚¯ï¼ˆã‚¹ãƒ†ãƒ¼ã‚¸ã•ã‚ŒãŸã‚‚ã®ã¨æ¯”è¼ƒï¼‰
        git diff --exit-code --quiet
        RESULT=$?

        # é€€é¿ã—ã¦ã„ãŸä½œæ¥­ãƒ„ãƒªãƒ¼ã‚’æˆ»ã™
        git stash pop --quiet || true

        # å·®åˆ†ãŒã‚ã£ãŸã‚‰ã‚³ãƒŸãƒƒãƒˆã‚’ä¸­æ–­
        if [ $RESULT -ne 0 ]; then
          echo "ğŸ’¡ ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«ã‚ˆã‚‹å¤‰æ›´ãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸã€‚ä¿®æ­£å†…å®¹ã‚’ç¢ºèªã—ã€å†åº¦ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ã—ã¦ãã ã•ã„ã€‚" && exit 1
        fi
